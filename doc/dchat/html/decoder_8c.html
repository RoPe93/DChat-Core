<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>DChat: src/decoder.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">DChat
   &#160;<span id="projectnumber">0.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('decoder_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">decoder.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains core functions to decode and encode DChat Packet Data Units.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &quot;dchat_h/decoder.h&quot;</code><br />
<code>#include &quot;dchat_h/network.h&quot;</code><br />
<code>#include &quot;dchat_h/log.h&quot;</code><br />
<code>#include &quot;dchat_h/util.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for decoder.c:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c__incl.png" border="0" usemap="#src_2decoder_8c" alt=""/></div>
<map name="src_2decoder_8c" id="src_2decoder_8c">
<area shape="rect" id="node7" href="decoder_8h_source.html" title="dchat_h/decoder.h" alt="" coords="331,155,463,181"/><area shape="rect" id="node10" href="network_8h_source.html" title="network.h" alt="" coords="556,304,636,331"/><area shape="rect" id="node12" href="log_8h_source.html" title="dchat_h/log.h" alt="" coords="114,80,216,107"/><area shape="rect" id="node16" href="util_8h_source.html" title="dchat_h/util.h" alt="" coords="477,80,579,107"/><area shape="rect" id="node8" href="types_8h_source.html" title="types.h" alt="" coords="365,229,429,256"/><area shape="rect" id="node14" href="option_8h_source.html" title="option.h" alt="" coords="187,155,256,181"/></map>
</div>
</div>
<p><a href="decoder_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acdc394373c1cbcfa66f99a9a4579e5c8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#acdc394373c1cbcfa66f99a9a4579e5c8">decode_header</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, char *line)</td></tr>
<tr class="memdesc:acdc394373c1cbcfa66f99a9a4579e5c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decodes a string into a DChat header.  <a href="#acdc394373c1cbcfa66f99a9a4579e5c8">More...</a><br /></td></tr>
<tr class="separator:acdc394373c1cbcfa66f99a9a4579e5c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a4f2d2d79d140c5d1bcb5be3bc82e0e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#a9a4f2d2d79d140c5d1bcb5be3bc82e0e">read_line</a> (int fd, char **line)</td></tr>
<tr class="memdesc:a9a4f2d2d79d140c5d1bcb5be3bc82e0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a line terminated with \n from a file descriptor.  <a href="#a9a4f2d2d79d140c5d1bcb5be3bc82e0e">More...</a><br /></td></tr>
<tr class="separator:a9a4f2d2d79d140c5d1bcb5be3bc82e0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5566b29faaf60fb8c68a3d97d3fadc3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#ac5566b29faaf60fb8c68a3d97d3fadc3">read_pdu</a> (int fd, <a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu)</td></tr>
<tr class="memdesc:ac5566b29faaf60fb8c68a3d97d3fadc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a whole DChat PDU from a file descriptor.  <a href="#ac5566b29faaf60fb8c68a3d97d3fadc3">More...</a><br /></td></tr>
<tr class="separator:ac5566b29faaf60fb8c68a3d97d3fadc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92bdcc4d06ae8c3fb41f6f0489a44891"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#a92bdcc4d06ae8c3fb41f6f0489a44891">encode_header</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, int header_id, char **headerline)</td></tr>
<tr class="memdesc:a92bdcc4d06ae8c3fb41f6f0489a44891"><td class="mdescLeft">&#160;</td><td class="mdescRight">Crafts a DChat header string.  <a href="#a92bdcc4d06ae8c3fb41f6f0489a44891">More...</a><br /></td></tr>
<tr class="separator:a92bdcc4d06ae8c3fb41f6f0489a44891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4aaf258b8866187ed65d6d1c23083cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#af4aaf258b8866187ed65d6d1c23083cb">write_pdu</a> (int fd, <a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu)</td></tr>
<tr class="memdesc:af4aaf258b8866187ed65d6d1c23083cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a PDU to a string that will be written to a file descriptor.  <a href="#af4aaf258b8866187ed65d6d1c23083cb">More...</a><br /></td></tr>
<tr class="separator:af4aaf258b8866187ed65d6d1c23083cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42be8c12ff007b95a9a98175c1738d0c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#a42be8c12ff007b95a9a98175c1738d0c">ver_str_to_pdu</a> (char *value, <a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu)</td></tr>
<tr class="memdesc:a42be8c12ff007b95a9a98175c1738d0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses the given value to a supported version of DChat and sets, if valid, its value in the PDU structure.  <a href="#a42be8c12ff007b95a9a98175c1738d0c">More...</a><br /></td></tr>
<tr class="separator:a42be8c12ff007b95a9a98175c1738d0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7a1420a7b9ce8077005793d5baa48b3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#af7a1420a7b9ce8077005793d5baa48b3">ctt_str_to_pdu</a> (char *value, <a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu)</td></tr>
<tr class="memdesc:af7a1420a7b9ce8077005793d5baa48b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses the given value to a supported content-type of DChat and sets, if valid, its value in the PDU structure.  <a href="#af7a1420a7b9ce8077005793d5baa48b3">More...</a><br /></td></tr>
<tr class="separator:af7a1420a7b9ce8077005793d5baa48b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a186b736b428ee1ba79bc538a560a9e28"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#a186b736b428ee1ba79bc538a560a9e28">ctl_str_to_pdu</a> (char *value, <a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu)</td></tr>
<tr class="memdesc:a186b736b428ee1ba79bc538a560a9e28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses the given value to a content-length and sets its value, if valid, in the given PDU structure.  <a href="#a186b736b428ee1ba79bc538a560a9e28">More...</a><br /></td></tr>
<tr class="separator:a186b736b428ee1ba79bc538a560a9e28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace47761936ccffbfbac61e6905d8333d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#ace47761936ccffbfbac61e6905d8333d">oni_str_to_pdu</a> (char *value, <a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu)</td></tr>
<tr class="memdesc:ace47761936ccffbfbac61e6905d8333d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses the given value to an onion address and sets its value , if valid, in the given PDU structure.  <a href="#ace47761936ccffbfbac61e6905d8333d">More...</a><br /></td></tr>
<tr class="separator:ace47761936ccffbfbac61e6905d8333d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93c5fb5eadf28693c56b187748a284b9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#a93c5fb5eadf28693c56b187748a284b9">lnp_str_to_pdu</a> (char *value, <a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu)</td></tr>
<tr class="memdesc:a93c5fb5eadf28693c56b187748a284b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses the given value to a listening port and sets its value, if valid, in the given PDU structure.  <a href="#a93c5fb5eadf28693c56b187748a284b9">More...</a><br /></td></tr>
<tr class="separator:a93c5fb5eadf28693c56b187748a284b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a21bca3a0374aeda651aba069d0bfb4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#a8a21bca3a0374aeda651aba069d0bfb4">nic_str_to_pdu</a> (char *value, <a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu)</td></tr>
<tr class="memdesc:a8a21bca3a0374aeda651aba069d0bfb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses the given value to a nickname and sets its value, if valid, in the given PDU structure.  <a href="#a8a21bca3a0374aeda651aba069d0bfb4">More...</a><br /></td></tr>
<tr class="separator:a8a21bca3a0374aeda651aba069d0bfb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1fb16f98ba7cba1d0e8394a0a825214"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#ad1fb16f98ba7cba1d0e8394a0a825214">dat_str_to_pdu</a> (char *value, <a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu)</td></tr>
<tr class="memdesc:ad1fb16f98ba7cba1d0e8394a0a825214"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses the given value to a struct tm and sets its value, if valid, in the given PDU structure.  <a href="#ad1fb16f98ba7cba1d0e8394a0a825214">More...</a><br /></td></tr>
<tr class="separator:ad1fb16f98ba7cba1d0e8394a0a825214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ff1abc0a14ba58a3c7bfd5cc81fc1f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#aa8ff1abc0a14ba58a3c7bfd5cc81fc1f">srv_str_to_pdu</a> (char *value, <a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu)</td></tr>
<tr class="memdesc:aa8ff1abc0a14ba58a3c7bfd5cc81fc1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses the given value to a server field and sets its value, if valid, in the given PDU structure.  <a href="#aa8ff1abc0a14ba58a3c7bfd5cc81fc1f">More...</a><br /></td></tr>
<tr class="separator:aa8ff1abc0a14ba58a3c7bfd5cc81fc1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae08df473fb28e4f06044d50f8428eafc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#ae08df473fb28e4f06044d50f8428eafc">ver_pdu_to_str</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, char **value)</td></tr>
<tr class="memdesc:ae08df473fb28e4f06044d50f8428eafc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts the version field in the PDU to a string and sets the address of the given value parameter to this string.  <a href="#ae08df473fb28e4f06044d50f8428eafc">More...</a><br /></td></tr>
<tr class="separator:ae08df473fb28e4f06044d50f8428eafc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ba39a2b36836a7dc2dbe548cd02c21f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#a9ba39a2b36836a7dc2dbe548cd02c21f">ctt_pdu_to_str</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, char **value)</td></tr>
<tr class="memdesc:a9ba39a2b36836a7dc2dbe548cd02c21f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts the content-type field in the PDU to a string and sets the address of the given value parameter to this string.  <a href="#a9ba39a2b36836a7dc2dbe548cd02c21f">More...</a><br /></td></tr>
<tr class="separator:a9ba39a2b36836a7dc2dbe548cd02c21f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa34bd8632014a3a135df77c5786bda6d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#aa34bd8632014a3a135df77c5786bda6d">ctl_pdu_to_str</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, char **value)</td></tr>
<tr class="memdesc:aa34bd8632014a3a135df77c5786bda6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts the content-length field in the PDU to a string and sets the address of the given value parameter to this string.  <a href="#aa34bd8632014a3a135df77c5786bda6d">More...</a><br /></td></tr>
<tr class="separator:aa34bd8632014a3a135df77c5786bda6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a019debfd4003c322fba5003b6c191129"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#a019debfd4003c322fba5003b6c191129">oni_pdu_to_str</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, char **value)</td></tr>
<tr class="memdesc:a019debfd4003c322fba5003b6c191129"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts the onion-id field in the PDU to a string and sets the address of the given value parameter to this string.  <a href="#a019debfd4003c322fba5003b6c191129">More...</a><br /></td></tr>
<tr class="separator:a019debfd4003c322fba5003b6c191129"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac89711a42de87d7b24f7e598b0167f85"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#ac89711a42de87d7b24f7e598b0167f85">lnp_pdu_to_str</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, char **value)</td></tr>
<tr class="memdesc:ac89711a42de87d7b24f7e598b0167f85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts the listening-port field in the PDU to a string and sets the address of the given value parameter to this string.  <a href="#ac89711a42de87d7b24f7e598b0167f85">More...</a><br /></td></tr>
<tr class="separator:ac89711a42de87d7b24f7e598b0167f85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f3472fbd176480725e69578245d3c61"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#a5f3472fbd176480725e69578245d3c61">nic_pdu_to_str</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, char **value)</td></tr>
<tr class="memdesc:a5f3472fbd176480725e69578245d3c61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts the nickname field in the PDU to a string and sets the address of the given value parameter to this string.  <a href="#a5f3472fbd176480725e69578245d3c61">More...</a><br /></td></tr>
<tr class="separator:a5f3472fbd176480725e69578245d3c61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab124906e75a01fb9448bf33eac5906da"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#ab124906e75a01fb9448bf33eac5906da">dat_pdu_to_str</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, char **value)</td></tr>
<tr class="memdesc:ab124906e75a01fb9448bf33eac5906da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts the sent field in the PDU to a string and sets the address of the given value parameter to this string.  <a href="#ab124906e75a01fb9448bf33eac5906da">More...</a><br /></td></tr>
<tr class="separator:ab124906e75a01fb9448bf33eac5906da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affa9e2c054d9f619c3cf426a4a2ed9c7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#affa9e2c054d9f619c3cf426a4a2ed9c7">srv_pdu_to_str</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, char **value)</td></tr>
<tr class="memdesc:affa9e2c054d9f619c3cf426a4a2ed9c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts the server field in the PDU to a string and sets the address of the given value parameter to this string.  <a href="#affa9e2c054d9f619c3cf426a4a2ed9c7">More...</a><br /></td></tr>
<tr class="separator:affa9e2c054d9f619c3cf426a4a2ed9c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab89ef1994dd9e9d401b4c0d5feb594b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#ab89ef1994dd9e9d401b4c0d5feb594b2">init_dchat_content_types</a> (<a class="el" href="structdchat__content__types.html">dchat_content_types_t</a> *ctt)</td></tr>
<tr class="memdesc:ab89ef1994dd9e9d401b4c0d5feb594b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a content-types structure with all available content-types in DChat.  <a href="#ab89ef1994dd9e9d401b4c0d5feb594b2">More...</a><br /></td></tr>
<tr class="separator:ab89ef1994dd9e9d401b4c0d5feb594b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed8d6a7e8b9b368fa54d7af2f2a5231e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#aed8d6a7e8b9b368fa54d7af2f2a5231e">init_dchat_v1</a> (<a class="el" href="structdchat__v1.html">dchat_v1_t</a> *proto)</td></tr>
<tr class="memdesc:aed8d6a7e8b9b368fa54d7af2f2a5231e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a DChat V1 structure containing all available and supported headers of the DChat V1 protocol.  <a href="#aed8d6a7e8b9b368fa54d7af2f2a5231e">More...</a><br /></td></tr>
<tr class="separator:aed8d6a7e8b9b368fa54d7af2f2a5231e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaf80c220fd915287452a6baa5b05e2e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#abaf80c220fd915287452a6baa5b05e2e">init_dchat_pdu</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, float version, int content_type, char *onion_id, int lport, char *nickname)</td></tr>
<tr class="memdesc:abaf80c220fd915287452a6baa5b05e2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a DChat PDU with the given values.  <a href="#abaf80c220fd915287452a6baa5b05e2e">More...</a><br /></td></tr>
<tr class="separator:abaf80c220fd915287452a6baa5b05e2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0e7619d80bc7c53c88b1e893eb00df5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#ac0e7619d80bc7c53c88b1e893eb00df5">init_dchat_pdu_content</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, char *content, int len)</td></tr>
<tr class="memdesc:ac0e7619d80bc7c53c88b1e893eb00df5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the content of a DChat PDU with the given value.  <a href="#ac0e7619d80bc7c53c88b1e893eb00df5">More...</a><br /></td></tr>
<tr class="separator:ac0e7619d80bc7c53c88b1e893eb00df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a64791a4f610ecaff285d91512ea927"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#a8a64791a4f610ecaff285d91512ea927">is_valid_version</a> (float version)</td></tr>
<tr class="memdesc:a8a64791a4f610ecaff285d91512ea927"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the given version is a valid and supported DChat version.  <a href="#a8a64791a4f610ecaff285d91512ea927">More...</a><br /></td></tr>
<tr class="separator:a8a64791a4f610ecaff285d91512ea927"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee415a9aa4d7252364a6aed14d8d1a50"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#aee415a9aa4d7252364a6aed14d8d1a50">is_valid_termination</a> (char *value)</td></tr>
<tr class="memdesc:aee415a9aa4d7252364a6aed14d8d1a50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the given string is terminated with <br />
 or <br />
 respectively.  <a href="#aee415a9aa4d7252364a6aed14d8d1a50">More...</a><br /></td></tr>
<tr class="separator:aee415a9aa4d7252364a6aed14d8d1a50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2960a3c598ee607801fc333b5d1cfce9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#a2960a3c598ee607801fc333b5d1cfce9">is_valid_content_type</a> (int content_type)</td></tr>
<tr class="memdesc:a2960a3c598ee607801fc333b5d1cfce9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the given Content-Type number is a valid DChat Content-Type.  <a href="#a2960a3c598ee607801fc333b5d1cfce9">More...</a><br /></td></tr>
<tr class="separator:a2960a3c598ee607801fc333b5d1cfce9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ecd7cbbbe72098afc1bd5508067d8e4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#a4ecd7cbbbe72098afc1bd5508067d8e4">is_valid_content_length</a> (int ctl)</td></tr>
<tr class="memdesc:a4ecd7cbbbe72098afc1bd5508067d8e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the given Content-Length is a valid DChat Content-Length.  <a href="#a4ecd7cbbbe72098afc1bd5508067d8e4">More...</a><br /></td></tr>
<tr class="separator:a4ecd7cbbbe72098afc1bd5508067d8e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a338364bcfd88f32a9b162c4e12bd3cad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#a338364bcfd88f32a9b162c4e12bd3cad">is_valid_nickname</a> (char *nickname)</td></tr>
<tr class="memdesc:a338364bcfd88f32a9b162c4e12bd3cad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the given nickname is a valid DChat nickname.  <a href="#a338364bcfd88f32a9b162c4e12bd3cad">More...</a><br /></td></tr>
<tr class="separator:a338364bcfd88f32a9b162c4e12bd3cad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade270b4d1100adbdffbb22fdd5635737"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#ade270b4d1100adbdffbb22fdd5635737">free_pdu</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu)</td></tr>
<tr class="memdesc:ade270b4d1100adbdffbb22fdd5635737"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees all resources dynamically allocated for a PDU structure.  <a href="#ade270b4d1100adbdffbb22fdd5635737">More...</a><br /></td></tr>
<tr class="separator:ade270b4d1100adbdffbb22fdd5635737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4502d6fa3578ce5f3b4a92e5489c978"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decoder_8c.html#ab4502d6fa3578ce5f3b4a92e5489c978">get_content_part</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, int offset, char term, char **content)</td></tr>
<tr class="memdesc:ab4502d6fa3578ce5f3b4a92e5489c978"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts a fraction of the content.  <a href="#ab4502d6fa3578ce5f3b4a92e5489c978">More...</a><br /></td></tr>
<tr class="separator:ab4502d6fa3578ce5f3b4a92e5489c978"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains core functions to decode and encode DChat Packet Data Units. </p>

<p>Definition in file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa34bd8632014a3a135df77c5786bda6d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ctl_pdu_to_str </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts the content-length field in the PDU to a string and sets the address of the given value parameter to this string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
    <tr><td class="paramname">value</td><td>Double pointer to string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 field was not set in pdu structure, 0 on success (string must be freed), -1 in case of error (e.g. illegal value in pdu structure , ...) </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00758">758</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_aa34bd8632014a3a135df77c5786bda6d_cgraph.png" border="0" usemap="#decoder_8c_aa34bd8632014a3a135df77c5786bda6d_cgraph" alt=""/></div>
<map name="decoder_8c_aa34bd8632014a3a135df77c5786bda6d_cgraph" id="decoder_8c_aa34bd8632014a3a135df77c5786bda6d_cgraph">
<area shape="rect" id="node2" href="decoder_8c.html#a4ecd7cbbbe72098afc1bd5508067d8e4" title="Checks if the given Content&#45;Length is a valid DChat Content&#45;Length. " alt="" coords="161,5,322,32"/><area shape="rect" id="node3" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="218,56,265,83"/><area shape="rect" id="node4" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="371,56,453,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a186b736b428ee1ba79bc538a560a9e28"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ctl_str_to_pdu </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses the given value to a content-length and sets its value, if valid, in the given PDU structure. </p>
<p>A valid content-length does not exceed MAX_CONTENT_LEN. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>String to parse </td></tr>
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if value is a valid content-length, -1 otherwise </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00525">525</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_a186b736b428ee1ba79bc538a560a9e28_cgraph.png" border="0" usemap="#decoder_8c_a186b736b428ee1ba79bc538a560a9e28_cgraph" alt=""/></div>
<map name="decoder_8c_a186b736b428ee1ba79bc538a560a9e28_cgraph" id="decoder_8c_a186b736b428ee1ba79bc538a560a9e28_cgraph">
<area shape="rect" id="node2" href="decoder_8c.html#a4ecd7cbbbe72098afc1bd5508067d8e4" title="Checks if the given Content&#45;Length is a valid DChat Content&#45;Length. " alt="" coords="161,5,322,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9ba39a2b36836a7dc2dbe548cd02c21f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ctt_pdu_to_str </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts the content-type field in the PDU to a string and sets the address of the given value parameter to this string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
    <tr><td class="paramname">value</td><td>Double pointer to string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 field was not set in pdu structure, 0 on success (string must be freed), -1 in case of error (e.g. illegal value in pdu structure , ...) </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00709">709</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_a9ba39a2b36836a7dc2dbe548cd02c21f_cgraph.png" border="0" usemap="#decoder_8c_a9ba39a2b36836a7dc2dbe548cd02c21f_cgraph" alt=""/></div>
<map name="decoder_8c_a9ba39a2b36836a7dc2dbe548cd02c21f_cgraph" id="decoder_8c_a9ba39a2b36836a7dc2dbe548cd02c21f_cgraph">
<area shape="rect" id="node2" href="decoder_8c.html#ab89ef1994dd9e9d401b4c0d5feb594b2" title="Initializes a content&#45;types structure with all available content&#45;types in DChat. " alt="" coords="160,5,291,46"/><area shape="rect" id="node3" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="202,71,249,97"/><area shape="rect" id="node4" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="339,71,421,97"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af7a1420a7b9ce8077005793d5baa48b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ctt_str_to_pdu </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses the given value to a supported content-type of DChat and sets, if valid, its value in the PDU structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>String to parse </td></tr>
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if value is a valid content-type, -1 otherwise </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00493">493</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_af7a1420a7b9ce8077005793d5baa48b3_cgraph.png" border="0" usemap="#decoder_8c_af7a1420a7b9ce8077005793d5baa48b3_cgraph" alt=""/></div>
<map name="decoder_8c_af7a1420a7b9ce8077005793d5baa48b3_cgraph" id="decoder_8c_af7a1420a7b9ce8077005793d5baa48b3_cgraph">
<area shape="rect" id="node2" href="decoder_8c.html#ab89ef1994dd9e9d401b4c0d5feb594b2" title="Initializes a content&#45;types structure with all available content&#45;types in DChat. " alt="" coords="160,5,291,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab124906e75a01fb9448bf33eac5906da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dat_pdu_to_str </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts the sent field in the PDU to a string and sets the address of the given value parameter to this string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
    <tr><td class="paramname">value</td><td>Double pointer to string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 field was not set in pdu structure, 0 on success (string must be freed), -1 in case of error (e.g. illegal value in pdu structure , ...) </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00894">894</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_ab124906e75a01fb9448bf33eac5906da_cgraph.png" border="0" usemap="#decoder_8c_ab124906e75a01fb9448bf33eac5906da_cgraph" alt=""/></div>
<map name="decoder_8c_ab124906e75a01fb9448bf33eac5906da_cgraph" id="decoder_8c_ab124906e75a01fb9448bf33eac5906da_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a14252469532ecf356f22412644467eba" title="Checks wether n successive bytes in the memory pointed by ptr are 0. " alt="" coords="166,5,223,32"/><area shape="rect" id="node3" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="171,56,218,83"/><area shape="rect" id="node4" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="272,56,355,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad1fb16f98ba7cba1d0e8394a0a825214"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dat_str_to_pdu </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses the given value to a struct tm and sets its value, if valid, in the given PDU structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>String to parse </td></tr>
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if value is a valid datetime string, -1 otherwise </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00631">631</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="acdc394373c1cbcfa66f99a9a4579e5c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int decode_header </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decodes a string into a DChat header. </p>
<p>Attempts to decode the given \n terminated line and sets corresponding header attributes in the given pdu. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure where header attributes will be set </td></tr>
    <tr><td class="paramname">line</td><td>Line to parse for dchat-headers; must be \n terminated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if line is a dchat header, -1 otherwise </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00051">51</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_acdc394373c1cbcfa66f99a9a4579e5c8_cgraph.png" border="0" usemap="#decoder_8c_acdc394373c1cbcfa66f99a9a4579e5c8_cgraph" alt=""/></div>
<map name="decoder_8c_acdc394373c1cbcfa66f99a9a4579e5c8_cgraph" id="decoder_8c_acdc394373c1cbcfa66f99a9a4579e5c8_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="575,340,622,367"/><area shape="rect" id="node4" href="decoder_8c.html#aee415a9aa4d7252364a6aed14d8d1a50" title="Checks if the given string is terminated with &#160;&#160;or &#160;&#160;respectively. " alt="" coords="169,442,309,468"/><area shape="rect" id="node5" href="decoder_8c.html#aed8d6a7e8b9b368fa54d7af2f2a5231e" title="Initializes a DChat V1 structure containing all available and supported headers of the DChat V1 proto..." alt="" coords="189,391,289,418"/><area shape="rect" id="node3" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="728,340,811,367"/><area shape="rect" id="node6" href="decoder_8c.html#a42be8c12ff007b95a9a98175c1738d0c" title="Parses the given value to a supported version of DChat and sets, if valid, its value in the PDU struc..." alt="" coords="358,594,469,620"/><area shape="rect" id="node7" href="decoder_8c.html#ae08df473fb28e4f06044d50f8428eafc" title="Converts the version field in the PDU to a string and sets the address of the given value parameter t..." alt="" coords="358,188,469,215"/><area shape="rect" id="node8" href="decoder_8c.html#af7a1420a7b9ce8077005793d5baa48b3" title="Parses the given value to a supported content&#45;type of DChat and sets, if valid, its value in the PDU ..." alt="" coords="360,36,467,63"/><area shape="rect" id="node10" href="decoder_8c.html#a9ba39a2b36836a7dc2dbe548cd02c21f" title="Converts the content&#45;type field in the PDU to a string and sets the address of the given value parame..." alt="" coords="360,87,467,114"/><area shape="rect" id="node11" href="decoder_8c.html#a186b736b428ee1ba79bc538a560a9e28" title="Parses the given value to a content&#45;length and sets its value, if valid, in the given PDU structure..." alt="" coords="361,644,466,671"/><area shape="rect" id="node13" href="decoder_8c.html#aa34bd8632014a3a135df77c5786bda6d" title="Converts the content&#45;length field in the PDU to a string and sets the address of the given value para..." alt="" coords="361,492,466,519"/><area shape="rect" id="node14" href="decoder_8c.html#ace47761936ccffbfbac61e6905d8333d" title="Parses the given value to an onion address and sets its value , if valid, in the given PDU structure..." alt="" coords="358,746,469,772"/><area shape="rect" id="node16" href="decoder_8c.html#a019debfd4003c322fba5003b6c191129" title="Converts the onion&#45;id field in the PDU to a string and sets the address of the given value parameter ..." alt="" coords="358,543,469,570"/><area shape="rect" id="node17" href="decoder_8c.html#a93c5fb5eadf28693c56b187748a284b9" title="Parses the given value to a listening port and sets its value, if valid, in the given PDU structure..." alt="" coords="358,796,469,823"/><area shape="rect" id="node19" href="decoder_8c.html#ac89711a42de87d7b24f7e598b0167f85" title="Converts the listening&#45;port field in the PDU to a string and sets the address of the given value para..." alt="" coords="358,695,469,722"/><area shape="rect" id="node20" href="decoder_8c.html#a8a21bca3a0374aeda651aba069d0bfb4" title="Parses the given value to a nickname and sets its value, if valid, in the given PDU structure..." alt="" coords="359,138,468,164"/><area shape="rect" id="node21" href="decoder_8c.html#a5f3472fbd176480725e69578245d3c61" title="Converts the nickname field in the PDU to a string and sets the address of the given value parameter ..." alt="" coords="359,391,468,418"/><area shape="rect" id="node23" href="decoder_8c.html#ad1fb16f98ba7cba1d0e8394a0a825214" title="Parses the given value to a struct tm and sets its value, if valid, in the given PDU structure..." alt="" coords="358,239,469,266"/><area shape="rect" id="node24" href="decoder_8c.html#ab124906e75a01fb9448bf33eac5906da" title="Converts the sent field in the PDU to a string and sets the address of the given value parameter to t..." alt="" coords="358,442,469,468"/><area shape="rect" id="node26" href="decoder_8c.html#aa8ff1abc0a14ba58a3c7bfd5cc81fc1f" title="Parses the given value to a server field and sets its value, if valid, in the given PDU structure..." alt="" coords="358,290,469,316"/><area shape="rect" id="node27" href="decoder_8c.html#affa9e2c054d9f619c3cf426a4a2ed9c7" title="Converts the server field in the PDU to a string and sets the address of the given value parameter to..." alt="" coords="358,340,469,367"/><area shape="rect" id="node9" href="decoder_8c.html#ab89ef1994dd9e9d401b4c0d5feb594b2" title="Initializes a content&#45;types structure with all available content&#45;types in DChat. " alt="" coords="533,54,664,96"/><area shape="rect" id="node12" href="decoder_8c.html#a4ecd7cbbbe72098afc1bd5508067d8e4" title="Checks if the given Content&#45;Length is a valid DChat Content&#45;Length. " alt="" coords="518,568,679,595"/><area shape="rect" id="node15" href="network_8c.html#a139629f69df293ba1da88fea96af5e5e" title="Checks wether the given onion&#45;id is a valid onion address. " alt="" coords="545,708,652,735"/><area shape="rect" id="node18" href="network_8c.html#a53aa686284d28600afef0e06d7ab3d54" title="Checks wether the given port is a valid TCP port. " alt="" coords="550,784,647,811"/><area shape="rect" id="node22" href="decoder_8c.html#a338364bcfd88f32a9b162c4e12bd3cad" title="Checks if the given nickname is a valid DChat nickname. " alt="" coords="533,391,664,418"/><area shape="rect" id="node25" href="util_8c.html#a14252469532ecf356f22412644467eba" title="Checks wether n successive bytes in the memory pointed by ptr are 0. " alt="" coords="570,442,627,468"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a92bdcc4d06ae8c3fb41f6f0489a44891"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int encode_header </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>header_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>headerline</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Crafts a DChat header string. </p>
<p>Crafts a header string according to the given header_id (see: dchat_encoder.h) together with the header information stored in the PDU structure. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to a message structure that holds header information like Content-Type, Content-Length, ... </td></tr>
    <tr><td class="paramname">header_id</td><td>Defines for which header a string should be crafted (Content-Type, ...) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to a header string (stored on heap -&gt; must be freed) or NULL on error This string is not terminated with \n or \r\n respectively </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00296">296</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_a92bdcc4d06ae8c3fb41f6f0489a44891_cgraph.png" border="0" usemap="#decoder_8c_a92bdcc4d06ae8c3fb41f6f0489a44891_cgraph" alt=""/></div>
<map name="decoder_8c_a92bdcc4d06ae8c3fb41f6f0489a44891_cgraph" id="decoder_8c_a92bdcc4d06ae8c3fb41f6f0489a44891_cgraph">
<area shape="rect" id="node2" href="decoder_8c.html#aed8d6a7e8b9b368fa54d7af2f2a5231e" title="Initializes a DChat V1 structure containing all available and supported headers of the DChat V1 proto..." alt="" coords="169,411,269,437"/><area shape="rect" id="node5" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="535,487,582,513"/><area shape="rect" id="node3" href="decoder_8c.html#a42be8c12ff007b95a9a98175c1738d0c" title="Parses the given value to a supported version of DChat and sets, if valid, its value in the PDU struc..." alt="" coords="318,512,429,539"/><area shape="rect" id="node4" href="decoder_8c.html#ae08df473fb28e4f06044d50f8428eafc" title="Converts the version field in the PDU to a string and sets the address of the given value parameter t..." alt="" coords="318,613,429,640"/><area shape="rect" id="node7" href="decoder_8c.html#af7a1420a7b9ce8077005793d5baa48b3" title="Parses the given value to a supported content&#45;type of DChat and sets, if valid, its value in the PDU ..." alt="" coords="320,5,427,32"/><area shape="rect" id="node9" href="decoder_8c.html#a9ba39a2b36836a7dc2dbe548cd02c21f" title="Converts the content&#45;type field in the PDU to a string and sets the address of the given value parame..." alt="" coords="320,157,427,184"/><area shape="rect" id="node10" href="decoder_8c.html#a186b736b428ee1ba79bc538a560a9e28" title="Parses the given value to a content&#45;length and sets its value, if valid, in the given PDU structure..." alt="" coords="321,816,426,843"/><area shape="rect" id="node12" href="decoder_8c.html#aa34bd8632014a3a135df77c5786bda6d" title="Converts the content&#45;length field in the PDU to a string and sets the address of the given value para..." alt="" coords="321,765,426,792"/><area shape="rect" id="node13" href="decoder_8c.html#ace47761936ccffbfbac61e6905d8333d" title="Parses the given value to an onion address and sets its value , if valid, in the given PDU structure..." alt="" coords="318,107,429,133"/><area shape="rect" id="node15" href="decoder_8c.html#a019debfd4003c322fba5003b6c191129" title="Converts the onion&#45;id field in the PDU to a string and sets the address of the given value parameter ..." alt="" coords="318,259,429,285"/><area shape="rect" id="node16" href="decoder_8c.html#a93c5fb5eadf28693c56b187748a284b9" title="Parses the given value to a listening port and sets its value, if valid, in the given PDU structure..." alt="" coords="318,56,429,83"/><area shape="rect" id="node18" href="decoder_8c.html#ac89711a42de87d7b24f7e598b0167f85" title="Converts the listening&#45;port field in the PDU to a string and sets the address of the given value para..." alt="" coords="318,208,429,235"/><area shape="rect" id="node19" href="decoder_8c.html#a8a21bca3a0374aeda651aba069d0bfb4" title="Parses the given value to a nickname and sets its value, if valid, in the given PDU structure..." alt="" coords="319,360,428,387"/><area shape="rect" id="node20" href="decoder_8c.html#a5f3472fbd176480725e69578245d3c61" title="Converts the nickname field in the PDU to a string and sets the address of the given value parameter ..." alt="" coords="319,664,428,691"/><area shape="rect" id="node22" href="decoder_8c.html#ad1fb16f98ba7cba1d0e8394a0a825214" title="Parses the given value to a struct tm and sets its value, if valid, in the given PDU structure..." alt="" coords="318,461,429,488"/><area shape="rect" id="node23" href="decoder_8c.html#ab124906e75a01fb9448bf33eac5906da" title="Converts the sent field in the PDU to a string and sets the address of the given value parameter to t..." alt="" coords="318,309,429,336"/><area shape="rect" id="node25" href="decoder_8c.html#aa8ff1abc0a14ba58a3c7bfd5cc81fc1f" title="Parses the given value to a server field and sets its value, if valid, in the given PDU structure..." alt="" coords="318,411,429,437"/><area shape="rect" id="node26" href="decoder_8c.html#affa9e2c054d9f619c3cf426a4a2ed9c7" title="Converts the server field in the PDU to a string and sets the address of the given value parameter to..." alt="" coords="318,563,429,589"/><area shape="rect" id="node6" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="688,487,771,513"/><area shape="rect" id="node8" href="decoder_8c.html#ab89ef1994dd9e9d401b4c0d5feb594b2" title="Initializes a content&#45;types structure with all available content&#45;types in DChat. " alt="" coords="493,17,624,58"/><area shape="rect" id="node11" href="decoder_8c.html#a4ecd7cbbbe72098afc1bd5508067d8e4" title="Checks if the given Content&#45;Length is a valid DChat Content&#45;Length. " alt="" coords="478,791,639,817"/><area shape="rect" id="node14" href="network_8c.html#a139629f69df293ba1da88fea96af5e5e" title="Checks wether the given onion&#45;id is a valid onion address. " alt="" coords="505,241,612,268"/><area shape="rect" id="node17" href="network_8c.html#a53aa686284d28600afef0e06d7ab3d54" title="Checks wether the given port is a valid TCP port. " alt="" coords="510,119,607,145"/><area shape="rect" id="node21" href="decoder_8c.html#a338364bcfd88f32a9b162c4e12bd3cad" title="Checks if the given nickname is a valid DChat nickname. " alt="" coords="493,664,624,691"/><area shape="rect" id="node24" href="util_8c.html#a14252469532ecf356f22412644467eba" title="Checks wether n successive bytes in the memory pointed by ptr are 0. " alt="" coords="530,309,587,336"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ade270b4d1100adbdffbb22fdd5635737"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_pdu </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees all resources dynamically allocated for a PDU structure. </p>
<p>This function frees the allocated memory for the content. In the future other fields may be freed. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to a PDU structure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l01230">1230</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab4502d6fa3578ce5f3b4a92e5489c978"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_content_part </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>term</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>content</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extracts a fraction of the content. </p>
<p>Part of the content of a PDU will be extracted beginning at offset and ending at the given terminating character term. The partial content, given as double pointer should be freed after the successfull call of this function. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to a pdu containing the content </td></tr>
    <tr><td class="paramname">offset</td><td>Offset where the extraction will begin </td></tr>
    <tr><td class="paramname">term</td><td>Terminating character where the extraction will end </td></tr>
    <tr><td class="paramname">content</td><td>Extracted content </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns offset where the terminating character has been found in the content of the pdu, -1 on error </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l01260">1260</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_ab4502d6fa3578ce5f3b4a92e5489c978_cgraph.png" border="0" usemap="#decoder_8c_ab4502d6fa3578ce5f3b4a92e5489c978_cgraph" alt=""/></div>
<map name="decoder_8c_ab4502d6fa3578ce5f3b4a92e5489c978_cgraph" id="decoder_8c_ab4502d6fa3578ce5f3b4a92e5489c978_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a021b18b681712d42cb07c99171691a84" title="Log a message. " alt="" coords="176,5,248,32"/><area shape="rect" id="node4" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="189,56,235,83"/><area shape="rect" id="node3" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="296,31,379,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab89ef1994dd9e9d401b4c0d5feb594b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_dchat_content_types </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__content__types.html">dchat_content_types_t</a> *&#160;</td>
          <td class="paramname"><em>ctt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a content-types structure with all available content-types in DChat. </p>
<p>The structure the given Pointer is pointing to, will be initialized with all content-types supported by DChat (e.g "text/plain", "control/discover", ...). The name of the content-type will be set, as well as its ID. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctt</td><td>Pointer to content-types structure to initialize </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Initialized content-types structure. </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00955">955</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="abaf80c220fd915287452a6baa5b05e2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_dchat_pdu </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>content_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>onion_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>nickname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a DChat PDU with the given values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure whose members will be initialized </td></tr>
    <tr><td class="paramname">version</td><td>Version of DChat Protocol </td></tr>
    <tr><td class="paramname">content_type</td><td>Content-Type </td></tr>
    <tr><td class="paramname">onion_id</td><td>Onion-ID </td></tr>
    <tr><td class="paramname">lport</td><td>Listening port </td></tr>
    <tr><td class="paramname">nickname</td><td>Nickname </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l01028">1028</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_abaf80c220fd915287452a6baa5b05e2e_cgraph.png" border="0" usemap="#decoder_8c_abaf80c220fd915287452a6baa5b05e2e_cgraph" alt=""/></div>
<map name="decoder_8c_abaf80c220fd915287452a6baa5b05e2e_cgraph" id="decoder_8c_abaf80c220fd915287452a6baa5b05e2e_cgraph">
<area shape="rect" id="node2" href="decoder_8c.html#a8a64791a4f610ecaff285d91512ea927" title="Checks if the given version is a valid and supported DChat version. " alt="" coords="180,5,297,32"/><area shape="rect" id="node3" href="log_8c.html#a021b18b681712d42cb07c99171691a84" title="Log a message. " alt="" coords="203,56,275,83"/><area shape="rect" id="node5" href="decoder_8c.html#a2960a3c598ee607801fc333b5d1cfce9" title="Checks if the given Content&#45;Type number is a valid DChat Content&#45;Type. " alt="" coords="163,107,314,133"/><area shape="rect" id="node6" href="network_8c.html#a139629f69df293ba1da88fea96af5e5e" title="Checks wether the given onion&#45;id is a valid onion address. " alt="" coords="185,157,292,184"/><area shape="rect" id="node7" href="network_8c.html#a53aa686284d28600afef0e06d7ab3d54" title="Checks wether the given port is a valid TCP port. " alt="" coords="190,208,287,235"/><area shape="rect" id="node8" href="decoder_8c.html#a338364bcfd88f32a9b162c4e12bd3cad" title="Checks if the given nickname is a valid DChat nickname. " alt="" coords="173,259,304,285"/><area shape="rect" id="node9" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="215,309,262,336"/><area shape="rect" id="node4" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="363,183,445,209"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac0e7619d80bc7c53c88b1e893eb00df5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_dchat_pdu_content </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the content of a DChat PDU with the given value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to PDU whose content will be initialized </td></tr>
    <tr><td class="paramname">content</td><td>Pointer to content </td></tr>
    <tr><td class="paramname">len</td><td>Lenght of content </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l01103">1103</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_ac0e7619d80bc7c53c88b1e893eb00df5_cgraph.png" border="0" usemap="#decoder_8c_ac0e7619d80bc7c53c88b1e893eb00df5_cgraph" alt=""/></div>
<map name="decoder_8c_ac0e7619d80bc7c53c88b1e893eb00df5_cgraph" id="decoder_8c_ac0e7619d80bc7c53c88b1e893eb00df5_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="214,5,261,32"/><area shape="rect" id="node3" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="309,5,392,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aed8d6a7e8b9b368fa54d7af2f2a5231e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_dchat_v1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__v1.html">dchat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>proto</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a DChat V1 structure containing all available and supported headers of the DChat V1 protocol. </p>
<p>The given structure will be initialized with all headers available. The header IDs and names will be set and function addresses pointing to corresponding value parsers will be set too. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proto</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if structure has been initialized successfully, -1 otherwise </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00989">989</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_aed8d6a7e8b9b368fa54d7af2f2a5231e_cgraph.png" border="0" usemap="#decoder_8c_aed8d6a7e8b9b368fa54d7af2f2a5231e_cgraph" alt=""/></div>
<map name="decoder_8c_aed8d6a7e8b9b368fa54d7af2f2a5231e_cgraph" id="decoder_8c_aed8d6a7e8b9b368fa54d7af2f2a5231e_cgraph">
<area shape="rect" id="node2" href="decoder_8c.html#a42be8c12ff007b95a9a98175c1738d0c" title="Parses the given value to a supported version of DChat and sets, if valid, its value in the PDU struc..." alt="" coords="155,5,266,32"/><area shape="rect" id="node3" href="decoder_8c.html#ae08df473fb28e4f06044d50f8428eafc" title="Converts the version field in the PDU to a string and sets the address of the given value parameter t..." alt="" coords="155,360,266,387"/><area shape="rect" id="node6" href="decoder_8c.html#af7a1420a7b9ce8077005793d5baa48b3" title="Parses the given value to a supported content&#45;type of DChat and sets, if valid, its value in the PDU ..." alt="" coords="157,56,264,83"/><area shape="rect" id="node8" href="decoder_8c.html#a9ba39a2b36836a7dc2dbe548cd02c21f" title="Converts the content&#45;type field in the PDU to a string and sets the address of the given value parame..." alt="" coords="157,107,264,133"/><area shape="rect" id="node9" href="decoder_8c.html#a186b736b428ee1ba79bc538a560a9e28" title="Parses the given value to a content&#45;length and sets its value, if valid, in the given PDU structure..." alt="" coords="158,157,263,184"/><area shape="rect" id="node11" href="decoder_8c.html#aa34bd8632014a3a135df77c5786bda6d" title="Converts the content&#45;length field in the PDU to a string and sets the address of the given value para..." alt="" coords="158,208,263,235"/><area shape="rect" id="node12" href="decoder_8c.html#ace47761936ccffbfbac61e6905d8333d" title="Parses the given value to an onion address and sets its value , if valid, in the given PDU structure..." alt="" coords="155,259,266,285"/><area shape="rect" id="node14" href="decoder_8c.html#a019debfd4003c322fba5003b6c191129" title="Converts the onion&#45;id field in the PDU to a string and sets the address of the given value parameter ..." alt="" coords="155,309,266,336"/><area shape="rect" id="node15" href="decoder_8c.html#a93c5fb5eadf28693c56b187748a284b9" title="Parses the given value to a listening port and sets its value, if valid, in the given PDU structure..." alt="" coords="155,715,266,741"/><area shape="rect" id="node17" href="decoder_8c.html#ac89711a42de87d7b24f7e598b0167f85" title="Converts the listening&#45;port field in the PDU to a string and sets the address of the given value para..." alt="" coords="155,664,266,691"/><area shape="rect" id="node18" href="decoder_8c.html#a8a21bca3a0374aeda651aba069d0bfb4" title="Parses the given value to a nickname and sets its value, if valid, in the given PDU structure..." alt="" coords="156,512,265,539"/><area shape="rect" id="node19" href="decoder_8c.html#a5f3472fbd176480725e69578245d3c61" title="Converts the nickname field in the PDU to a string and sets the address of the given value parameter ..." alt="" coords="156,563,265,589"/><area shape="rect" id="node21" href="decoder_8c.html#ad1fb16f98ba7cba1d0e8394a0a825214" title="Parses the given value to a struct tm and sets its value, if valid, in the given PDU structure..." alt="" coords="155,613,266,640"/><area shape="rect" id="node22" href="decoder_8c.html#ab124906e75a01fb9448bf33eac5906da" title="Converts the sent field in the PDU to a string and sets the address of the given value parameter to t..." alt="" coords="155,765,266,792"/><area shape="rect" id="node24" href="decoder_8c.html#aa8ff1abc0a14ba58a3c7bfd5cc81fc1f" title="Parses the given value to a server field and sets its value, if valid, in the given PDU structure..." alt="" coords="155,411,266,437"/><area shape="rect" id="node25" href="decoder_8c.html#affa9e2c054d9f619c3cf426a4a2ed9c7" title="Converts the server field in the PDU to a string and sets the address of the given value parameter to..." alt="" coords="155,461,266,488"/><area shape="rect" id="node4" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="373,411,419,437"/><area shape="rect" id="node5" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="525,411,608,437"/><area shape="rect" id="node7" href="decoder_8c.html#ab89ef1994dd9e9d401b4c0d5feb594b2" title="Initializes a content&#45;types structure with all available content&#45;types in DChat. " alt="" coords="331,74,461,115"/><area shape="rect" id="node10" href="decoder_8c.html#a4ecd7cbbbe72098afc1bd5508067d8e4" title="Checks if the given Content&#45;Length is a valid DChat Content&#45;Length. " alt="" coords="315,183,477,209"/><area shape="rect" id="node13" href="network_8c.html#a139629f69df293ba1da88fea96af5e5e" title="Checks wether the given onion&#45;id is a valid onion address. " alt="" coords="343,284,449,311"/><area shape="rect" id="node16" href="network_8c.html#a53aa686284d28600afef0e06d7ab3d54" title="Checks wether the given port is a valid TCP port. " alt="" coords="347,689,445,716"/><area shape="rect" id="node20" href="decoder_8c.html#a338364bcfd88f32a9b162c4e12bd3cad" title="Checks if the given nickname is a valid DChat nickname. " alt="" coords="331,563,461,589"/><area shape="rect" id="node23" href="util_8c.html#a14252469532ecf356f22412644467eba" title="Checks wether n successive bytes in the memory pointed by ptr are 0. " alt="" coords="367,765,425,792"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4ecd7cbbbe72098afc1bd5508067d8e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int is_valid_content_length </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the given Content-Length is a valid DChat Content-Length. </p>
<p>Content-Length must be between 0 and MAX_CONTENT_LEN. </p><dl class="section return"><dt>Returns</dt><dd>1 if valid, 0 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l01187">1187</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2960a3c598ee607801fc333b5d1cfce9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int is_valid_content_type </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>content_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the given Content-Type number is a valid DChat Content-Type. </p>
<dl class="section return"><dt>Returns</dt><dd>1 if valid, 0 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l01170">1170</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="a338364bcfd88f32a9b162c4e12bd3cad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int is_valid_nickname </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>nickname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the given nickname is a valid DChat nickname. </p>
<dl class="section return"><dt>Returns</dt><dd>1 if valid, 0 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l01203">1203</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="aee415a9aa4d7252364a6aed14d8d1a50"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int is_valid_termination </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the given string is terminated with <br />
 or <br />
 respectively. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>String to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Index of termination character, -1 otherwise </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l01137">1137</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8a64791a4f610ecaff285d91512ea927"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int is_valid_version </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>version</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the given version is a valid and supported DChat version. </p>
<dl class="section return"><dt>Returns</dt><dd>1 if valid, 0 otherwise </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l01120">1120</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac89711a42de87d7b24f7e598b0167f85"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int lnp_pdu_to_str </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts the listening-port field in the PDU to a string and sets the address of the given value parameter to this string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
    <tr><td class="paramname">value</td><td>Double pointer to string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 field was not set in pdu structure, 0 on success (string must be freed), -1 in case of error (e.g. illegal value in pdu structure , ...) </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00825">825</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_ac89711a42de87d7b24f7e598b0167f85_cgraph.png" border="0" usemap="#decoder_8c_ac89711a42de87d7b24f7e598b0167f85_cgraph" alt=""/></div>
<map name="decoder_8c_ac89711a42de87d7b24f7e598b0167f85_cgraph" id="decoder_8c_ac89711a42de87d7b24f7e598b0167f85_cgraph">
<area shape="rect" id="node2" href="network_8c.html#a53aa686284d28600afef0e06d7ab3d54" title="Checks wether the given port is a valid TCP port. " alt="" coords="166,5,263,32"/><area shape="rect" id="node3" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="191,56,238,83"/><area shape="rect" id="node4" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="312,56,395,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a93c5fb5eadf28693c56b187748a284b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int lnp_str_to_pdu </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses the given value to a listening port and sets its value, if valid, in the given PDU structure. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="network_8c.html#a53aa686284d28600afef0e06d7ab3d54" title="Checks wether the given port is a valid TCP port. ">is_valid_port</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>String to parse </td></tr>
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if value is a valid listening port, -1 otherwise </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00579">579</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_a93c5fb5eadf28693c56b187748a284b9_cgraph.png" border="0" usemap="#decoder_8c_a93c5fb5eadf28693c56b187748a284b9_cgraph" alt=""/></div>
<map name="decoder_8c_a93c5fb5eadf28693c56b187748a284b9_cgraph" id="decoder_8c_a93c5fb5eadf28693c56b187748a284b9_cgraph">
<area shape="rect" id="node2" href="network_8c.html#a53aa686284d28600afef0e06d7ab3d54" title="Checks wether the given port is a valid TCP port. " alt="" coords="166,5,263,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5f3472fbd176480725e69578245d3c61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nic_pdu_to_str </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts the nickname field in the PDU to a string and sets the address of the given value parameter to this string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
    <tr><td class="paramname">value</td><td>Double pointer to string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 field was not set in pdu structure, 0 on success (string must be freed), -1 in case of error (e.g. illegal value in pdu structure , ...) </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00860">860</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_a5f3472fbd176480725e69578245d3c61_cgraph.png" border="0" usemap="#decoder_8c_a5f3472fbd176480725e69578245d3c61_cgraph" alt=""/></div>
<map name="decoder_8c_a5f3472fbd176480725e69578245d3c61_cgraph" id="decoder_8c_a5f3472fbd176480725e69578245d3c61_cgraph">
<area shape="rect" id="node2" href="decoder_8c.html#a338364bcfd88f32a9b162c4e12bd3cad" title="Checks if the given nickname is a valid DChat nickname. " alt="" coords="163,5,293,32"/><area shape="rect" id="node3" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="205,56,251,83"/><area shape="rect" id="node4" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="341,56,424,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8a21bca3a0374aeda651aba069d0bfb4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nic_str_to_pdu </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses the given value to a nickname and sets its value, if valid, in the given PDU structure. </p>
<p>MAX_NICKNAME characters will be copied to the PDU structure, thus if the given value is longer the rest will be cut off. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>String to parse </td></tr>
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if value is a valid nickname, -1 otherwise </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00607">607</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="a019debfd4003c322fba5003b6c191129"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int oni_pdu_to_str </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts the onion-id field in the PDU to a string and sets the address of the given value parameter to this string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
    <tr><td class="paramname">value</td><td>Double pointer to string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 field was not set in pdu structure, 0 on success (string must be freed), -1 in case of error (e.g. illegal value in pdu structure , ...) </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00787">787</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_a019debfd4003c322fba5003b6c191129_cgraph.png" border="0" usemap="#decoder_8c_a019debfd4003c322fba5003b6c191129_cgraph" alt=""/></div>
<map name="decoder_8c_a019debfd4003c322fba5003b6c191129_cgraph" id="decoder_8c_a019debfd4003c322fba5003b6c191129_cgraph">
<area shape="rect" id="node2" href="network_8c.html#a139629f69df293ba1da88fea96af5e5e" title="Checks wether the given onion&#45;id is a valid onion address. " alt="" coords="165,5,272,32"/><area shape="rect" id="node3" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="195,56,242,83"/><area shape="rect" id="node4" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="320,56,403,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ace47761936ccffbfbac61e6905d8333d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int oni_str_to_pdu </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses the given value to an onion address and sets its value , if valid, in the given PDU structure. </p>
<p>A valid onion address is max. 16 characters long (22 characters including the prefix ".onion"). </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="network_8c.html#a139629f69df293ba1da88fea96af5e5e" title="Checks wether the given onion-id is a valid onion address. ">is_valid_onion</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>String to parse </td></tr>
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if value is a valid onion address, -1 otherwise </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00554">554</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_ace47761936ccffbfbac61e6905d8333d_cgraph.png" border="0" usemap="#decoder_8c_ace47761936ccffbfbac61e6905d8333d_cgraph" alt=""/></div>
<map name="decoder_8c_ace47761936ccffbfbac61e6905d8333d_cgraph" id="decoder_8c_ace47761936ccffbfbac61e6905d8333d_cgraph">
<area shape="rect" id="node2" href="network_8c.html#a139629f69df293ba1da88fea96af5e5e" title="Checks wether the given onion&#45;id is a valid onion address. " alt="" coords="165,5,272,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9a4f2d2d79d140c5d1bcb5be3bc82e0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_line </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a line terminated with \n from a file descriptor. </p>
<p>Reads a line from the given file descriptor until \n is found. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>File descriptor to read from </td></tr>
    <tr><td class="paramname">line</td><td>Double pointer used for dynamic memory allocation since characters will be stored on the heap. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: length of bytes read, 0 on EOF, -1 on error </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00144">144</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_a9a4f2d2d79d140c5d1bcb5be3bc82e0e_cgraph.png" border="0" usemap="#decoder_8c_a9a4f2d2d79d140c5d1bcb5be3bc82e0e_cgraph" alt=""/></div>
<map name="decoder_8c_a9a4f2d2d79d140c5d1bcb5be3bc82e0e_cgraph" id="decoder_8c_a9a4f2d2d79d140c5d1bcb5be3bc82e0e_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="131,5,178,32"/><area shape="rect" id="node3" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="227,5,309,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac5566b29faaf60fb8c68a3d97d3fadc3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_pdu </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a whole DChat PDU from a file descriptor. </p>
<p>Read linewise from a file descriptor to form a DChat protocol data unit. Information read from the file descriptor will be stored in this pdu. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>File descriptor to read from </td></tr>
    <tr><td class="paramname">pdu</td><td>Pointer to a PDU structure whose headers will be filled. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>amount of bytes read in total if a protocol data unit has been read successfully, 0 on EOF , -1 on error </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00196">196</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_ac5566b29faaf60fb8c68a3d97d3fadc3_cgraph.png" border="0" usemap="#decoder_8c_ac5566b29faaf60fb8c68a3d97d3fadc3_cgraph" alt=""/></div>
<map name="decoder_8c_ac5566b29faaf60fb8c68a3d97d3fadc3_cgraph" id="decoder_8c_ac5566b29faaf60fb8c68a3d97d3fadc3_cgraph">
<area shape="rect" id="node2" href="decoder_8c.html#a9a4f2d2d79d140c5d1bcb5be3bc82e0e" title="Read a line terminated with \n from a file descriptor. " alt="" coords="328,867,405,893"/><area shape="rect" id="node5" href="decoder_8c.html#acdc394373c1cbcfa66f99a9a4579e5c8" title="Decodes a string into a DChat header. " alt="" coords="133,639,248,665"/><area shape="rect" id="node30" href="log_8c.html#a021b18b681712d42cb07c99171691a84" title="Log a message. " alt="" coords="155,917,227,944"/><area shape="rect" id="node3" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="703,588,750,615"/><area shape="rect" id="node4" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="856,753,939,780"/><area shape="rect" id="node6" href="decoder_8c.html#aee415a9aa4d7252364a6aed14d8d1a50" title="Checks if the given string is terminated with &#160;&#160;or &#160;&#160;respectively. " alt="" coords="297,385,437,412"/><area shape="rect" id="node7" href="decoder_8c.html#aed8d6a7e8b9b368fa54d7af2f2a5231e" title="Initializes a DChat V1 structure containing all available and supported headers of the DChat V1 proto..." alt="" coords="317,436,417,463"/><area shape="rect" id="node8" href="decoder_8c.html#a42be8c12ff007b95a9a98175c1738d0c" title="Parses the given value to a supported version of DChat and sets, if valid, its value in the PDU struc..." alt="" coords="486,664,597,691"/><area shape="rect" id="node9" href="decoder_8c.html#ae08df473fb28e4f06044d50f8428eafc" title="Converts the version field in the PDU to a string and sets the address of the given value parameter t..." alt="" coords="486,715,597,741"/><area shape="rect" id="node10" href="decoder_8c.html#af7a1420a7b9ce8077005793d5baa48b3" title="Parses the given value to a supported content&#45;type of DChat and sets, if valid, its value in the PDU ..." alt="" coords="488,309,595,336"/><area shape="rect" id="node12" href="decoder_8c.html#a9ba39a2b36836a7dc2dbe548cd02c21f" title="Converts the content&#45;type field in the PDU to a string and sets the address of the given value parame..." alt="" coords="488,360,595,387"/><area shape="rect" id="node13" href="decoder_8c.html#a186b736b428ee1ba79bc538a560a9e28" title="Parses the given value to a content&#45;length and sets its value, if valid, in the given PDU structure..." alt="" coords="489,5,594,32"/><area shape="rect" id="node15" href="decoder_8c.html#aa34bd8632014a3a135df77c5786bda6d" title="Converts the content&#45;length field in the PDU to a string and sets the address of the given value para..." alt="" coords="489,56,594,83"/><area shape="rect" id="node16" href="decoder_8c.html#ace47761936ccffbfbac61e6905d8333d" title="Parses the given value to an onion address and sets its value , if valid, in the given PDU structure..." alt="" coords="486,107,597,133"/><area shape="rect" id="node18" href="decoder_8c.html#a019debfd4003c322fba5003b6c191129" title="Converts the onion&#45;id field in the PDU to a string and sets the address of the given value parameter ..." alt="" coords="486,208,597,235"/><area shape="rect" id="node19" href="decoder_8c.html#a93c5fb5eadf28693c56b187748a284b9" title="Parses the given value to a listening port and sets its value, if valid, in the given PDU structure..." alt="" coords="486,157,597,184"/><area shape="rect" id="node21" href="decoder_8c.html#ac89711a42de87d7b24f7e598b0167f85" title="Converts the listening&#45;port field in the PDU to a string and sets the address of the given value para..." alt="" coords="486,259,597,285"/><area shape="rect" id="node22" href="decoder_8c.html#a8a21bca3a0374aeda651aba069d0bfb4" title="Parses the given value to a nickname and sets its value, if valid, in the given PDU structure..." alt="" coords="487,411,596,437"/><area shape="rect" id="node23" href="decoder_8c.html#a5f3472fbd176480725e69578245d3c61" title="Converts the nickname field in the PDU to a string and sets the address of the given value parameter ..." alt="" coords="487,765,596,792"/><area shape="rect" id="node25" href="decoder_8c.html#ad1fb16f98ba7cba1d0e8394a0a825214" title="Parses the given value to a struct tm and sets its value, if valid, in the given PDU structure..." alt="" coords="486,461,597,488"/><area shape="rect" id="node26" href="decoder_8c.html#ab124906e75a01fb9448bf33eac5906da" title="Converts the sent field in the PDU to a string and sets the address of the given value parameter to t..." alt="" coords="486,512,597,539"/><area shape="rect" id="node28" href="decoder_8c.html#aa8ff1abc0a14ba58a3c7bfd5cc81fc1f" title="Parses the given value to a server field and sets its value, if valid, in the given PDU structure..." alt="" coords="486,563,597,589"/><area shape="rect" id="node29" href="decoder_8c.html#affa9e2c054d9f619c3cf426a4a2ed9c7" title="Converts the server field in the PDU to a string and sets the address of the given value parameter to..." alt="" coords="486,613,597,640"/><area shape="rect" id="node11" href="decoder_8c.html#ab89ef1994dd9e9d401b4c0d5feb594b2" title="Initializes a content&#45;types structure with all available content&#45;types in DChat. " alt="" coords="661,327,792,369"/><area shape="rect" id="node14" href="decoder_8c.html#a4ecd7cbbbe72098afc1bd5508067d8e4" title="Checks if the given Content&#45;Length is a valid DChat Content&#45;Length. " alt="" coords="646,31,807,57"/><area shape="rect" id="node17" href="network_8c.html#a139629f69df293ba1da88fea96af5e5e" title="Checks wether the given onion&#45;id is a valid onion address. " alt="" coords="673,132,780,159"/><area shape="rect" id="node20" href="network_8c.html#a53aa686284d28600afef0e06d7ab3d54" title="Checks wether the given port is a valid TCP port. " alt="" coords="678,221,775,248"/><area shape="rect" id="node24" href="decoder_8c.html#a338364bcfd88f32a9b162c4e12bd3cad" title="Checks if the given nickname is a valid DChat nickname. " alt="" coords="661,765,792,792"/><area shape="rect" id="node27" href="util_8c.html#a14252469532ecf356f22412644467eba" title="Checks wether n successive bytes in the memory pointed by ptr are 0. " alt="" coords="698,512,755,539"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="affa9e2c054d9f619c3cf426a4a2ed9c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int srv_pdu_to_str </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts the server field in the PDU to a string and sets the address of the given value parameter to this string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
    <tr><td class="paramname">value</td><td>Double pointer to string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 field was not set in pdu structure, 0 on success (string must be freed), -1 in case of error (e.g. illegal value in pdu structure , ...) </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00925">925</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_affa9e2c054d9f619c3cf426a4a2ed9c7_cgraph.png" border="0" usemap="#decoder_8c_affa9e2c054d9f619c3cf426a4a2ed9c7_cgraph" alt=""/></div>
<map name="decoder_8c_affa9e2c054d9f619c3cf426a4a2ed9c7_cgraph" id="decoder_8c_affa9e2c054d9f619c3cf426a4a2ed9c7_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="166,5,213,32"/><area shape="rect" id="node3" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="261,5,344,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa8ff1abc0a14ba58a3c7bfd5cc81fc1f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int srv_str_to_pdu </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses the given value to a server field and sets its value, if valid, in the given PDU structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>String to parse </td></tr>
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if value is a valid server string, -1 otherwise </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00650">650</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_aa8ff1abc0a14ba58a3c7bfd5cc81fc1f_cgraph.png" border="0" usemap="#decoder_8c_aa8ff1abc0a14ba58a3c7bfd5cc81fc1f_cgraph" alt=""/></div>
<map name="decoder_8c_aa8ff1abc0a14ba58a3c7bfd5cc81fc1f_cgraph" id="decoder_8c_aa8ff1abc0a14ba58a3c7bfd5cc81fc1f_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="166,5,213,32"/><area shape="rect" id="node3" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="261,5,344,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae08df473fb28e4f06044d50f8428eafc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ver_pdu_to_str </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts the version field in the PDU to a string and sets the address of the given value parameter to this string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
    <tr><td class="paramname">value</td><td>Double pointer to string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 field was not set in pdu structure, 0 on success (string must be freed), -1 in case of error (e.g. illegal value in pdu structure , ...) </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00672">672</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_ae08df473fb28e4f06044d50f8428eafc_cgraph.png" border="0" usemap="#decoder_8c_ae08df473fb28e4f06044d50f8428eafc_cgraph" alt=""/></div>
<map name="decoder_8c_ae08df473fb28e4f06044d50f8428eafc_cgraph" id="decoder_8c_ae08df473fb28e4f06044d50f8428eafc_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="166,5,213,32"/><area shape="rect" id="node3" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="261,5,344,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a42be8c12ff007b95a9a98175c1738d0c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ver_str_to_pdu </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses the given value to a supported version of DChat and sets, if valid, its value in the PDU structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>String to parse </td></tr>
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if value is a valid version, -1 otherwise </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00471">471</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="af4aaf258b8866187ed65d6d1c23083cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int write_pdu </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a PDU to a string that will be written to a file descriptor. </p>
<p>Converts the given PDU to string which then will be written to the given file descriptor. First the headers of the PDU will be written, then an empty line and at last the content. (See specification of the dchat protocol) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>File descriptor where the dchat PDU will be written to </td></tr>
    <tr><td class="paramname">pdu</td><td>Pointer to a PDU structure holding the header and content data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Amount of bytes of content that that have been written. This should be equal to the value defined in the attribute "content_length" of the given PDU structure or -1 in case of error </dd></dl>

<p>Definition at line <a class="el" href="decoder_8c_source.html#l00374">374</a> of file <a class="el" href="decoder_8c_source.html">decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decoder_8c_af4aaf258b8866187ed65d6d1c23083cb_cgraph.png" border="0" usemap="#decoder_8c_af4aaf258b8866187ed65d6d1c23083cb_cgraph" alt=""/></div>
<map name="decoder_8c_af4aaf258b8866187ed65d6d1c23083cb_cgraph" id="decoder_8c_af4aaf258b8866187ed65d6d1c23083cb_cgraph">
<area shape="rect" id="node2" href="decoder_8c.html#aed8d6a7e8b9b368fa54d7af2f2a5231e" title="Initializes a DChat V1 structure containing all available and supported headers of the DChat V1 proto..." alt="" coords="297,436,397,463"/><area shape="rect" id="node5" href="log_8c.html#a677da14e8c4326bde43622f233f1ead3" title="Prints an error message and terminates this program. " alt="" coords="663,563,710,589"/><area shape="rect" id="node27" href="decoder_8c.html#a92bdcc4d06ae8c3fb41f6f0489a44891" title="Crafts a DChat header string. " alt="" coords="133,613,248,640"/><area shape="rect" id="node3" href="decoder_8c.html#a42be8c12ff007b95a9a98175c1738d0c" title="Parses the given value to a supported version of DChat and sets, if valid, its value in the PDU struc..." alt="" coords="446,461,557,488"/><area shape="rect" id="node4" href="decoder_8c.html#ae08df473fb28e4f06044d50f8428eafc" title="Converts the version field in the PDU to a string and sets the address of the given value parameter t..." alt="" coords="446,613,557,640"/><area shape="rect" id="node7" href="decoder_8c.html#af7a1420a7b9ce8077005793d5baa48b3" title="Parses the given value to a supported content&#45;type of DChat and sets, if valid, its value in the PDU ..." alt="" coords="448,867,555,893"/><area shape="rect" id="node9" href="decoder_8c.html#a9ba39a2b36836a7dc2dbe548cd02c21f" title="Converts the content&#45;type field in the PDU to a string and sets the address of the given value parame..." alt="" coords="448,816,555,843"/><area shape="rect" id="node10" href="decoder_8c.html#a186b736b428ee1ba79bc538a560a9e28" title="Parses the given value to a content&#45;length and sets its value, if valid, in the given PDU structure..." alt="" coords="449,5,554,32"/><area shape="rect" id="node12" href="decoder_8c.html#aa34bd8632014a3a135df77c5786bda6d" title="Converts the content&#45;length field in the PDU to a string and sets the address of the given value para..." alt="" coords="449,56,554,83"/><area shape="rect" id="node13" href="decoder_8c.html#ace47761936ccffbfbac61e6905d8333d" title="Parses the given value to an onion address and sets its value , if valid, in the given PDU structure..." alt="" coords="446,107,557,133"/><area shape="rect" id="node15" href="decoder_8c.html#a019debfd4003c322fba5003b6c191129" title="Converts the onion&#45;id field in the PDU to a string and sets the address of the given value parameter ..." alt="" coords="446,157,557,184"/><area shape="rect" id="node16" href="decoder_8c.html#a93c5fb5eadf28693c56b187748a284b9" title="Parses the given value to a listening port and sets its value, if valid, in the given PDU structure..." alt="" coords="446,208,557,235"/><area shape="rect" id="node18" href="decoder_8c.html#ac89711a42de87d7b24f7e598b0167f85" title="Converts the listening&#45;port field in the PDU to a string and sets the address of the given value para..." alt="" coords="446,259,557,285"/><area shape="rect" id="node19" href="decoder_8c.html#a8a21bca3a0374aeda651aba069d0bfb4" title="Parses the given value to a nickname and sets its value, if valid, in the given PDU structure..." alt="" coords="447,360,556,387"/><area shape="rect" id="node20" href="decoder_8c.html#a5f3472fbd176480725e69578245d3c61" title="Converts the nickname field in the PDU to a string and sets the address of the given value parameter ..." alt="" coords="447,309,556,336"/><area shape="rect" id="node22" href="decoder_8c.html#ad1fb16f98ba7cba1d0e8394a0a825214" title="Parses the given value to a struct tm and sets its value, if valid, in the given PDU structure..." alt="" coords="446,411,557,437"/><area shape="rect" id="node23" href="decoder_8c.html#ab124906e75a01fb9448bf33eac5906da" title="Converts the sent field in the PDU to a string and sets the address of the given value parameter to t..." alt="" coords="446,664,557,691"/><area shape="rect" id="node25" href="decoder_8c.html#aa8ff1abc0a14ba58a3c7bfd5cc81fc1f" title="Parses the given value to a server field and sets its value, if valid, in the given PDU structure..." alt="" coords="446,512,557,539"/><area shape="rect" id="node26" href="decoder_8c.html#affa9e2c054d9f619c3cf426a4a2ed9c7" title="Converts the server field in the PDU to a string and sets the address of the given value parameter to..." alt="" coords="446,563,557,589"/><area shape="rect" id="node6" href="log_8c.html#a38678da7483f269b8c96f83a8f45ef12" title="Log a message to a file. " alt="" coords="816,563,899,589"/><area shape="rect" id="node8" href="decoder_8c.html#ab89ef1994dd9e9d401b4c0d5feb594b2" title="Initializes a content&#45;types structure with all available content&#45;types in DChat. " alt="" coords="621,834,752,875"/><area shape="rect" id="node11" href="decoder_8c.html#a4ecd7cbbbe72098afc1bd5508067d8e4" title="Checks if the given Content&#45;Length is a valid DChat Content&#45;Length. " alt="" coords="606,31,767,57"/><area shape="rect" id="node14" href="network_8c.html#a139629f69df293ba1da88fea96af5e5e" title="Checks wether the given onion&#45;id is a valid onion address. " alt="" coords="633,145,740,172"/><area shape="rect" id="node17" href="network_8c.html#a53aa686284d28600afef0e06d7ab3d54" title="Checks wether the given port is a valid TCP port. " alt="" coords="638,221,735,248"/><area shape="rect" id="node21" href="decoder_8c.html#a338364bcfd88f32a9b162c4e12bd3cad" title="Checks if the given nickname is a valid DChat nickname. " alt="" coords="621,309,752,336"/><area shape="rect" id="node24" href="util_8c.html#a14252469532ecf356f22412644467eba" title="Checks wether n successive bytes in the memory pointed by ptr are 0. " alt="" coords="658,664,715,691"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="decoder_8c.html">decoder.c</a></li>
    <li class="footer">Generated on Tue Aug 12 2014 19:39:08 for DChat by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
