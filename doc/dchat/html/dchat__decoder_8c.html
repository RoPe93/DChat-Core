<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>DChat: src/dchat_decoder.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">DChat
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dchat__decoder_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">dchat_decoder.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains core functions to decode and encode DChat Packet Data Units.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;arpa/inet.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;sys/uio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &quot;dchat_h/dchat_decoder.h&quot;</code><br />
<code>#include &quot;dchat_h/log.h&quot;</code><br />
<code>#include &quot;dchat_h/util.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for dchat_decoder.c:</div>
<div class="dyncontent">
<div class="center"><img src="dchat__decoder_8c__incl.png" border="0" usemap="#src_2dchat__decoder_8c" alt=""/></div>
<map name="src_2dchat__decoder_8c" id="src_2dchat__decoder_8c">
<area shape="rect" id="node10" href="dchat__decoder_8h_source.html" title="dchat_h/dchat_decoder.h" alt="" coords="775,80,947,107"/><area shape="rect" id="node13" href="log_8h_source.html" title="dchat_h/log.h" alt="" coords="971,80,1073,107"/><area shape="rect" id="node15" href="util_8h_source.html" title="dchat_h/util.h" alt="" coords="1099,80,1200,107"/><area shape="rect" id="node11" href="dchat__types_8h_source.html" title="dchat_types.h" alt="" coords="829,155,933,181"/></map>
</div>
</div>
<p><a href="dchat__decoder_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acdc394373c1cbcfa66f99a9a4579e5c8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dchat__decoder_8c.html#acdc394373c1cbcfa66f99a9a4579e5c8">decode_header</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, char *line)</td></tr>
<tr class="memdesc:acdc394373c1cbcfa66f99a9a4579e5c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decodes a string into a DChat header.  <a href="#acdc394373c1cbcfa66f99a9a4579e5c8">More...</a><br /></td></tr>
<tr class="separator:acdc394373c1cbcfa66f99a9a4579e5c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a4f2d2d79d140c5d1bcb5be3bc82e0e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dchat__decoder_8c.html#a9a4f2d2d79d140c5d1bcb5be3bc82e0e">read_line</a> (int fd, char **line)</td></tr>
<tr class="memdesc:a9a4f2d2d79d140c5d1bcb5be3bc82e0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a line terminated with \n from a file descriptor.  <a href="#a9a4f2d2d79d140c5d1bcb5be3bc82e0e">More...</a><br /></td></tr>
<tr class="separator:a9a4f2d2d79d140c5d1bcb5be3bc82e0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0ceb4d749dc162f86d73d4f08ed5fa4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dchat__decoder_8c.html#ae0ceb4d749dc162f86d73d4f08ed5fa4">read_pdu</a> (int fd, <a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> **pdu)</td></tr>
<tr class="memdesc:ae0ceb4d749dc162f86d73d4f08ed5fa4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a whole DChat PDU from a file descriptor.  <a href="#ae0ceb4d749dc162f86d73d4f08ed5fa4">More...</a><br /></td></tr>
<tr class="separator:ae0ceb4d749dc162f86d73d4f08ed5fa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5745b50cd3cc0aa6228e35d08690fdc"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dchat__decoder_8c.html#ae5745b50cd3cc0aa6228e35d08690fdc">encode_header</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, int header_id)</td></tr>
<tr class="memdesc:ae5745b50cd3cc0aa6228e35d08690fdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Crafts a DChat header string.  <a href="#ae5745b50cd3cc0aa6228e35d08690fdc">More...</a><br /></td></tr>
<tr class="separator:ae5745b50cd3cc0aa6228e35d08690fdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab470071662c436c931b9d1e6fafb94b8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dchat__decoder_8c.html#ab470071662c436c931b9d1e6fafb94b8">write_line</a> (int fd, char *buf)</td></tr>
<tr class="memdesc:ab470071662c436c931b9d1e6fafb94b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a \r\n terminated line to a file descriptor.  <a href="#ab470071662c436c931b9d1e6fafb94b8">More...</a><br /></td></tr>
<tr class="separator:ab470071662c436c931b9d1e6fafb94b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4aaf258b8866187ed65d6d1c23083cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dchat__decoder_8c.html#af4aaf258b8866187ed65d6d1c23083cb">write_pdu</a> (int fd, <a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu)</td></tr>
<tr class="memdesc:af4aaf258b8866187ed65d6d1c23083cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a PDU to a string that will be written to a file descriptor.  <a href="#af4aaf258b8866187ed65d6d1c23083cb">More...</a><br /></td></tr>
<tr class="separator:af4aaf258b8866187ed65d6d1c23083cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade270b4d1100adbdffbb22fdd5635737"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dchat__decoder_8c.html#ade270b4d1100adbdffbb22fdd5635737">free_pdu</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu)</td></tr>
<tr class="memdesc:ade270b4d1100adbdffbb22fdd5635737"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees all resources dynamically allocated for a PDU structure.  <a href="#ade270b4d1100adbdffbb22fdd5635737">More...</a><br /></td></tr>
<tr class="separator:ade270b4d1100adbdffbb22fdd5635737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4502d6fa3578ce5f3b4a92e5489c978"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dchat__decoder_8c.html#ab4502d6fa3578ce5f3b4a92e5489c978">get_content_part</a> (<a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *pdu, int offset, char term, char **content)</td></tr>
<tr class="memdesc:ab4502d6fa3578ce5f3b4a92e5489c978"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts a fraction of the content.  <a href="#ab4502d6fa3578ce5f3b4a92e5489c978">More...</a><br /></td></tr>
<tr class="separator:ab4502d6fa3578ce5f3b4a92e5489c978"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains core functions to decode and encode DChat Packet Data Units. </p>

<p>Definition in file <a class="el" href="dchat__decoder_8c_source.html">dchat_decoder.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="acdc394373c1cbcfa66f99a9a4579e5c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int decode_header </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decodes a string into a DChat header. </p>
<p>Attempts to decode the given <br />
 terminated line and sets corresponding header attributes in the given pdu. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to PDU structure where header attributes will be set </td></tr>
    <tr><td class="paramname">line</td><td>Line to parse for dchat-headers; must be <br />
 terminated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if line is a dchat header, -1 otherwise </dd></dl>

<p>Definition at line <a class="el" href="dchat__decoder_8c_source.html#l00052">52</a> of file <a class="el" href="dchat__decoder_8c_source.html">dchat_decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dchat__decoder_8c_acdc394373c1cbcfa66f99a9a4579e5c8_cgraph.png" border="0" usemap="#dchat__decoder_8c_acdc394373c1cbcfa66f99a9a4579e5c8_cgraph" alt=""/></div>
<map name="dchat__decoder_8c_acdc394373c1cbcfa66f99a9a4579e5c8_cgraph" id="dchat__decoder_8c_acdc394373c1cbcfa66f99a9a4579e5c8_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a447124894e44d19ff906633927930c19" title="Log a message together with a string representation of errno as error. " alt="" coords="169,5,247,32"/><area shape="rect" id="node3" href="log_8c.html#a021b18b681712d42cb07c99171691a84" title="Log a message. " alt="" coords="296,5,368,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae5745b50cd3cc0aa6228e35d08690fdc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* encode_header </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>header_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Crafts a DChat header string. </p>
<p>Crafts a header string according to the given header_id (see: dchat_encoder.h) together with the header information stored in the PDU structure. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to a message structure that holds header information like Content-Type, Content-Length, ... </td></tr>
    <tr><td class="paramname">header_id</td><td>Defines for which header a string should be crafted (Content-Type, ...) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to a header string (stored on heap -&gt; must be freed) or NULL on error This string is not terminated with \n or \r\n respectively </dd></dl>

<p>Definition at line <a class="el" href="dchat__decoder_8c_source.html#l00393">393</a> of file <a class="el" href="dchat__decoder_8c_source.html">dchat_decoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="ade270b4d1100adbdffbb22fdd5635737"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_pdu </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees all resources dynamically allocated for a PDU structure. </p>
<p>This function frees the allocated memory for the content of this PDU and the dynamically allocated memory for this PDU itself. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to a pdu that has been dynamically allocated and should be freed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="dchat__decoder_8c_source.html#l00640">640</a> of file <a class="el" href="dchat__decoder_8c_source.html">dchat_decoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab4502d6fa3578ce5f3b4a92e5489c978"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_content_part </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>term</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>content</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extracts a fraction of the content. </p>
<p>Part of the content of a PDU will be extracted beginning at offset and ending at the given terminating character term. The partial content, given as double pointer should be freed after the successfull call of this function. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdu</td><td>Pointer to a pdu containing the content </td></tr>
    <tr><td class="paramname">offset</td><td>Offset where the extraction will begin </td></tr>
    <tr><td class="paramname">term</td><td>Terminating character where the extraction will end </td></tr>
    <tr><td class="paramname">content</td><td>Extracted content </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns offset where the terminating character has been found in the content of the pdu, -1 on error </dd></dl>

<p>Definition at line <a class="el" href="dchat__decoder_8c_source.html#l00670">670</a> of file <a class="el" href="dchat__decoder_8c_source.html">dchat_decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dchat__decoder_8c_ab4502d6fa3578ce5f3b4a92e5489c978_cgraph.png" border="0" usemap="#dchat__decoder_8c_ab4502d6fa3578ce5f3b4a92e5489c978_cgraph" alt=""/></div>
<map name="dchat__decoder_8c_ab4502d6fa3578ce5f3b4a92e5489c978_cgraph" id="dchat__decoder_8c_ab4502d6fa3578ce5f3b4a92e5489c978_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a021b18b681712d42cb07c99171691a84" title="Log a message. " alt="" coords="176,5,248,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9a4f2d2d79d140c5d1bcb5be3bc82e0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_line </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a line terminated with \n from a file descriptor. </p>
<p>Reads a line from the given file descriptor until \n is found. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>File descriptor to read from </td></tr>
    <tr><td class="paramname">line</td><td>Double pointer used for dynamic memory allocation since characters will be stored on the heap. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: length of bytes read, 0 on EOF, -1 on error </dd></dl>

<p>Definition at line <a class="el" href="dchat__decoder_8c_source.html#l00206">206</a> of file <a class="el" href="dchat__decoder_8c_source.html">dchat_decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dchat__decoder_8c_a9a4f2d2d79d140c5d1bcb5be3bc82e0e_cgraph.png" border="0" usemap="#dchat__decoder_8c_a9a4f2d2d79d140c5d1bcb5be3bc82e0e_cgraph" alt=""/></div>
<map name="dchat__decoder_8c_a9a4f2d2d79d140c5d1bcb5be3bc82e0e_cgraph" id="dchat__decoder_8c_a9a4f2d2d79d140c5d1bcb5be3bc82e0e_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a447124894e44d19ff906633927930c19" title="Log a message together with a string representation of errno as error. " alt="" coords="131,5,210,32"/><area shape="rect" id="node3" href="log_8c.html#a021b18b681712d42cb07c99171691a84" title="Log a message. " alt="" coords="259,5,331,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae0ceb4d749dc162f86d73d4f08ed5fa4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_pdu </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> **&#160;</td>
          <td class="paramname"><em>pdu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a whole DChat PDU from a file descriptor. </p>
<p>Read linewise from a file descriptor to form a dynamically allocated dchat protocol data unit. Information read from the file descriptor will be stored in this pdu. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>File descriptor to read from </td></tr>
    <tr><td class="paramname">pdu</td><td>Double pointer to a PDU that will be assigned the address of the dynamically allocated PDU structure. Therefore it is recommended to free it, if this structure is not used anymore. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>amount of bytes read in total if a protocol data unit has been read successfully, 0 on EOF , -1 on error </dd></dl>

<p>Definition at line <a class="el" href="dchat__decoder_8c_source.html#l00283">283</a> of file <a class="el" href="dchat__decoder_8c_source.html">dchat_decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dchat__decoder_8c_ae0ceb4d749dc162f86d73d4f08ed5fa4_cgraph.png" border="0" usemap="#dchat__decoder_8c_ae0ceb4d749dc162f86d73d4f08ed5fa4_cgraph" alt=""/></div>
<map name="dchat__decoder_8c_ae0ceb4d749dc162f86d73d4f08ed5fa4_cgraph" id="dchat__decoder_8c_ae0ceb4d749dc162f86d73d4f08ed5fa4_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a447124894e44d19ff906633927930c19" title="Log a message together with a string representation of errno as error. " alt="" coords="297,23,375,49"/><area shape="rect" id="node4" href="dchat__decoder_8c.html#a9a4f2d2d79d140c5d1bcb5be3bc82e0e" title="Read a line terminated with \n from a file descriptor. " alt="" coords="152,23,229,49"/><area shape="rect" id="node5" href="dchat__decoder_8c.html#acdc394373c1cbcfa66f99a9a4579e5c8" title="Decodes a string into a DChat header. " alt="" coords="133,73,248,100"/><area shape="rect" id="node3" href="log_8c.html#a021b18b681712d42cb07c99171691a84" title="Log a message. " alt="" coords="424,23,496,49"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab470071662c436c931b9d1e6fafb94b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int write_line </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes a \r\n terminated line to a file descriptor. </p>
<p>Writes the given buffer and additionally \r\n to the file descriptor. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>File descriptor where the data will be written to </td></tr>
    <tr><td class="paramname">buf</td><td>Pointer to a buffer holding the data that shall be written. The buffer must be \0 terminated! </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Amount of bytes that have been written (inkl. appended \r\n) </dd></dl>

<p>Definition at line <a class="el" href="dchat__decoder_8c_source.html#l00500">500</a> of file <a class="el" href="dchat__decoder_8c_source.html">dchat_decoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="af4aaf258b8866187ed65d6d1c23083cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int write_pdu </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdchat__pdu.html">dchat_pdu_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a PDU to a string that will be written to a file descriptor. </p>
<p>Converts the given PDU to string which then will be written to the given file descriptor. First the headers of the PDU will be written, then an empty line and at last the content. (See specification of the dchat protocol) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>File descriptor where the dchat PDU will be written to </td></tr>
    <tr><td class="paramname">pdu</td><td>Pointer to a PDU structure holding the header and content data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Amount of bytes of content that that have been written. This should be equal to the value defined in the attribute "content_length" of the given PDU structure </dd></dl>
<p>get Content-Type string </p>

<p>Definition at line <a class="el" href="dchat__decoder_8c_source.html#l00554">554</a> of file <a class="el" href="dchat__decoder_8c_source.html">dchat_decoder.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dchat__decoder_8c_af4aaf258b8866187ed65d6d1c23083cb_cgraph.png" border="0" usemap="#dchat__decoder_8c_af4aaf258b8866187ed65d6d1c23083cb_cgraph" alt=""/></div>
<map name="dchat__decoder_8c_af4aaf258b8866187ed65d6d1c23083cb_cgraph" id="dchat__decoder_8c_af4aaf258b8866187ed65d6d1c23083cb_cgraph">
<area shape="rect" id="node2" href="dchat__decoder_8c.html#ae5745b50cd3cc0aa6228e35d08690fdc" title="Crafts a DChat header string. " alt="" coords="133,5,248,32"/><area shape="rect" id="node3" href="log_8c.html#a021b18b681712d42cb07c99171691a84" title="Log a message. " alt="" coords="155,56,227,83"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dchat__decoder_8c.html">dchat_decoder.c</a></li>
    <li class="footer">Generated on Sun Jun 22 2014 16:56:01 for DChat by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
